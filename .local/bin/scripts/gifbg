#!/bin/sh
# Uses xwinwrap to display animated .gif on the root window
# Dependencies:
#	- gifsicle
#	- xwinwrap

if [ $# -ne 1 ]; then
    echo 1>&2 Usage: $0 image.gif
    exit 1
fi

# get screen resolution
SCRW=$(xrandr | awk '/current/ { print $8 }')
SCRH=$(xrandr | awk '/current/ { print $10 }')
SCRH=${SCRH%\,}

# get gif resolution
IMGWH=$(gifsicle --info "$1" | awk '/logical/ { print $3 }')
IMGW=${IMGWH%x*}
IMGH=${IMGWH#*x}

#calculate position
POSW=$(((SCRW/2)-(IMGW/2)))
POSH=$(((SCRH/2)-(IMGH/2)))

# Set background for small gifs with extcol script:
[ ! "$IMGWH" = "${SCRW}x${SCRH}" ] && bg="$(extcol "$1" "$IMGW" "$SCRW")" && hsetroot -solid "$bg"
# Display gif
xwinwrap -g ${IMGWH}+${POSW}+${POSH} -ov -ni -s -nf -- gifview --memory-limit 200 -w WID $1 -a --no-interactive

exit 0
