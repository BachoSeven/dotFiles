#!/bin/sh

if [ "$(file --extension -b "$1")" = "png" ]; then
	colors -p < "$1" \
	| sed "s/^/<span color='/;s/$/'>███████████████████████████████████████<\/span>/" \
	> /tmp/gifcols
else
	convert "$1" +dither -colors 5 -unique-colors txt: \
	| tail -n +2 \
	| awk '{print substr($3,1)}' \
	| sort \
	| sed "s/^/<span color='/;s/$/'>███████████████████████████████████████<\/span>/" \
	> /tmp/gifcols
fi

roficolsel /tmp/gifcols

# | dmenu -p "Select a color" # Pipe into this instead of the sed+rofi commands to remove the color preview functionality
