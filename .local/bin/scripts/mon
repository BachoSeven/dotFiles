#!/bin/sh

# Francesco Minnocci 2020
# This takes care of my external monitor setup, mostly for non-interactive purposes.

main() {
  int=${int:-eDP-1}
  ext=${ext:-DP-1}
  info=$(xrandr -q | grep "\b$ext connected")
  echo $info
  if [ -n "$info" ]; then
    while getopts ":elm" o; do
      case "${o}" in
        e) # External
          xrandr --output $int --off --output $ext --auto --dpi 144 ;;
        l) # Laptop
          xrandr --output $ext --off --output $int --auto ;;
        m) # Multi
          xrandr --output $int --auto --output $ext --primary --auto --right-of eDP-1 --dpi 96 ;;
        *)
          printf "Invalid option: -%s\n" "$OPTARG"
          printf "usage: $name [-e|-m|-l]\n" && exit 1 ;;
      esac
    done
    sbg # redraw background
    dunstreload # Reload dunst configuration
  fi
}

# The actual script starts here
name="$(basename $0)"
main "$@"
